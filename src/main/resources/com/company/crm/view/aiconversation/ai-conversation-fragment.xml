<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<fragment xmlns="http://jmix.io/schema/flowui/fragment">
    <data>
        <instance id="conversationDc" class="com.company.crm.ai.entity.AiConversation" provided="true"/>
        <collection id="messagesDc" class="com.company.crm.ai.entity.ChatMessage">
            <fetchPlan extends="_base">
                <property name="conversation" fetchPlan="_base"/>
            </fetchPlan>
            <loader id="messagesDl">
                <query>
                    <![CDATA[select e from ChatMessage e where e.conversation = :conversation order by e.createdDate]]>
                </query>
            </loader>
        </collection>
    </data>
    <content>
        <vbox width="100%" height="100%" spacing="false" padding="false">
            <messageList id="messageList"
                        width="100%"
                        height="100%"
                        themeNames="no-border"/>
            <progressBar id="progressBar"
                        width="100%"
                        visible="false"
                        indeterminate="true"/>
            <messageInput id="messageInput"
                         width="100%"/>
        </vbox>
    </content>
</fragment>